#Default compose args
pwd
ls -la
COMPOSE_ARGS=" -f identijenk/jenkins.yml -p jenkins "

#Make sure old containers are gone
sudo docker-compose $COMPOSE_ARGS stop
sudo docker-compose $COMPOSE_ARGS rm --force -v

#build the system
#sudo docker-compose $COMPOSE_ARGS build --no-cache
sudo docker-compose $COMPOSE_ARGS build
sudo docker-compose $COMPOSE_ARGS up -d
sudo docker exec -d jenkins_identitest_1 Xvfb :99 -screen 0 1024x768x24 &
sudo docker exec -d jenkins_identitest_1 java -jar /src/selenium-server-standalone-3.4.0.jar &
sudo docker exec -e XUNIT_FILE=output/xunit.xml jenkins_identitest_1 /src/node_modules/mocha/bin/mocha -R xunit-file -d /src/test2.js
sudo docker cp jenkins_identitest_1:output/xunit.xml ~/workspace/samplejob/xunit.xml

#Pull down the system
sudo docker-compose $COMPOSE_ARGS stop
sudo docker-compose $COMPOSE_ARGS rm --force -v

